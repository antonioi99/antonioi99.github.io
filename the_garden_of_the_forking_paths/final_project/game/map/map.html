<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Map - The Garden of Forking Paths</title>
    <link rel="stylesheet" href="map.css">
    <link rel="stylesheet" href="../game.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <header>
        <h1>Story Map: The Garden of Forking Paths</h1>
        <p class="subtitle">Interactive Visualization of Narrative Paths</p>
    </header>

    <nav class="controls">
        <div class="control-group">
            <label>Filter by Type:</label>
            <select id="type-filter">
                <option value="all">All Nodes</option>
                <option value="intro">Introduction</option>
                <option value="library">Library</option>
                <option value="garden">Garden</option>
                <option value="forest">Forest</option>
                <option value="village">Village</option>
                <option value="tower">Tower</option>
                <option value="mirror">Mirror</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>
                <input type="checkbox" id="time-distortion-only"> 
                Show only time distortion nodes
            </label>
        </div>
        
        <div class="control-group">
            <label>
                <input type="checkbox" id="choice-nodes-only"> 
                Show only choice nodes
            </label>
        </div>
        
        <div class="control-group">
            <button id="reset-view">Reset View</button>
            <button id="center-graph">Center Graph</button>
        </div>
    </nav>

    <main class="map-container">
        <div class="visualization-panel">
            <div id="story-map"></div>
        </div>
        
        <aside class="info-panel">
            <div class="map-legend">
                <h3>Legend</h3>
                <div class="legend-item">
                    <div class="legend-color intro-node"></div>
                    <span>Introduction</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color library-node"></div>
                    <span>Library</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color garden-node"></div>
                    <span>Garden</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color forest-node"></div>
                    <span>Forest</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color village-node"></div>
                    <span>Village</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color tower-node"></div>
                    <span>Tower</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color mirror-node"></div>
                    <span>Mirror</span>
                </div>
                <div class="legend-item">
                    <div class="legend-indicator time-distortion"></div>
                    <span>Time Distortion</span>
                </div>
                <div class="legend-item">
                    <div class="legend-indicator choice-node"></div>
                    <span>Choice Node</span>
                </div>
            </div>

            <div class="find-node">
                <h3>Find Node</h3>
                <div class="find-node-controls">
                    <select id="find-node-selector">
                        <option value="">Select a node...</option>
                    </select>
                    <button id="find-node-button">Go to Node</button>
                </div>
            </div>

            <div class="node-details">
                <h3>Node Information</h3>
                <div id="node-info">
                    <p>Click on a node to see details</p>
                </div>
            </div>
            
            <div class="path-finder">
                <h3>Path Finder</h3>
                <div class="path-controls">
                    <select id="start-node">
                        <option value="">Select start node...</option>
                    </select>
                    <select id="end-node">
                        <option value="">Select end node...</option>
                    </select>
                    <button id="find-paths">Find Paths</button>
                </div>
                <div id="path-results"></div>
            </div>

            <div class="path-analysis">
                <h3>Path Analysis</h3>
                <div id="path-stats">
                    <div class="stat-item">
                        <span class="stat-label">Total Nodes:</span>
                        <span id="total-nodes">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Choice Nodes:</span>
                        <span id="choice-nodes-count">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Navigation Nodes:</span>
                        <span id="nav-nodes-count">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Ending Nodes:</span>
                        <span id="ending-nodes-count">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Time Distortion Nodes:</span>
                        <span id="time-distortion-count">-</span>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <footer>
        <div class="instructions">
            <h4>How to Use:</h4>
            <ul>
                <li><strong>Pan:</strong> Click and drag the background</li>
                <li><strong>Zoom:</strong> Use mouse wheel or pinch gesture</li>
                <li><strong>Node Details:</strong> Click any node to see information</li>
                <li><strong>Highlight Paths:</strong> Hover over connections to see relationships</li>
                <li><strong>Filter:</strong> Use controls above to focus on specific node types</li>
            </ul>
        </div>
        <p class="attribution">
            Story structure from "The Garden of Forking Paths" inspired by Jorge Luis Borges
        </p>
    </footer>

    <!-- Import the story data -->
    <script src="../story.js"></script>
    <!-- Import the map visualization logic -->
    <script src="./map.js"></script>
</body>
</html>